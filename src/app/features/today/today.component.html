<ActionBar title="Prayer Streaks"></ActionBar>

<ScrollView>
  <StackLayout class="px-5 pt-5 pb-8">
    <!-- Streak display -->
    <StackLayout class="text-center p-6 rounded-2xl bg-white dark:bg-[#1c1c1e] mb-6">
      <!-- iOS: SF Symbol -->
      <Image
        *ngIf="isIOS"
        src="sys://flame.fill"
        tintColor="#f97316"
        width="52" height="52"
        class="mb-1"
      ></Image>
      <!-- Android: Material Icon -->
      <Label
        *ngIf="!isIOS"
        [text]="flameIcon"
        class="material-icon text-center text-orange-500 mb-1"
        style="font-size: 52"
      ></Label>
      <Label
        [text]="checkinService.currentStreak()"
        class="text-center font-bold text-orange-500"
        style="font-size: 52"
      ></Label>
      <Label
        [text]="streakText()"
        class="text-center text-xl text-gray-500 dark:text-gray-400 mt-2"
      ></Label>
      <Label
        text="One prayerful day at a time."
        class="text-center text-sm text-gray-400 dark:text-gray-500 mt-2"
      ></Label>
    </StackLayout>

    @if (!checkinService.checkedInToday()) {
      <!-- Prayer type selector -->
      <Label
        text="Prayer type (optional):"
        class="text-base text-gray-500 dark:text-gray-400 ml-1 mb-2"
      ></Label>
      <WrapLayout class="mb-6">
        @for (type of checkinService.prayerTypes(); track type) {
          <Label
            [text]="prayerTypeLabel(type)"
            [class]="
              'mr-2 mb-2 py-2 px-4 rounded-full text-base font-medium border ' +
              (selectedType() === type
                ? 'bg-blue-600 text-white border-blue-600'
                : 'bg-white dark:bg-[#1c1c1e] text-gray-700 dark:text-gray-300 border-gray-200 dark:border-gray-600')
            "
            (tap)="selectType(type)"
          ></Label>
        }
      </WrapLayout>

      <!-- Check-in button -->
      <Button
        text="I Prayed Today"
        (tap)="onCheckIn()"
        class="bg-blue-600 text-white text-xl p-4 rounded-2xl font-bold"
      ></Button>
    } @else {
      <!-- Confirmation -->
      <StackLayout class="text-center p-8 rounded-2xl bg-white dark:bg-[#1c1c1e]">
        <!-- iOS: SF Symbol -->
        <Image
          *ngIf="isIOS"
          src="sys://checkmark.circle.fill"
          tintColor="#22c55e"
          width="52" height="52"
          class="mb-1"
        ></Image>
        <!-- Android: Material Icon -->
        <Label
          *ngIf="!isIOS"
          [text]="checkIcon"
          class="material-icon text-center text-green-500 mb-1"
          style="font-size: 52"
        ></Label>
        <Label
          text="Checked in today!"
          class="text-center text-2xl font-bold text-green-600 mt-3"
        ></Label>
        <Label
          text="Come back tomorrow to keep your streak alive."
          class="text-center text-sm text-gray-500 dark:text-gray-400 mt-2"
        ></Label>
      </StackLayout>
    }
  </StackLayout>
</ScrollView>
